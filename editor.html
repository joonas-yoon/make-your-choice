<!DOCTYPE html>  <!-- HTML5 document type -->
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>[Editor] The Game You Choose - 인생은 선택의 연속이다</title>
  <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
  <link rel="icon" href="./favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="assets/font-awesome/css/all.min.css" type="text/css" />
  <link rel="stylesheet" href="editor.css" type="text/css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- use go-debug.js when developing and go.js when deploying -->
  <script src="assets/gojs/release/go.js"></script>
  <script src="assets/gojs/extensions/Figures.js"></script>
</head>
<body>
  <div id="navbar" class="nav">
    <a href="#" class="item"><i class="fas fa-th-list"></i></a>
    <a href="#" class="item"><i class="fas fa-play"></i></a>
    <a href="#" class="item"><i class="fas fa-save"></i></a>
    <a href="#" class="item active"><i class="fas fa-edit"></i></a>
    <a href="#" class="item"><i class="fas fa-cog"></i></a>
  </div>
  <div id="content">
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer porta, mauris vel tristique ullamcorper, lectus est lobortis eros, sit amet volutpat velit lacus eu nibh. Integer odio mi, feugiat egestas iaculis a, suscipit vel lorem. Nullam facilisis ipsum arcu, sed sodales nisi finibus at.</p>
    <p>Vestibulum viverra efficitur lectus, at commodo ante dapibus quis. Sed at nulla non nunc porttitor lobortis eu in urna. Cras hendrerit pellentesque mauris, nec tincidunt arcu. Cras nisl purus, porta sed orci non, tempor cursus tellus. Nam id massa augue. Curabitur odio eros, sagittis sit amet dignissim non, maximus et urna.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed nulla est, eleifend sit amet lobortis sodales, tempor et nulla.</p>
    <br>
    <p>Etiam viverra scelerisque eros, non efficitur neque vestibulum nec. Aenean viverra nisl ac orci convallis viverra. Duis at consequat libero. Donec auctor felis eu ex imperdiet, at varius nibh ullamcorper. Curabitur ac imperdiet massa. Fusce eget tempus tellus. Sed id justo viverra dolor porttitor volutpat. Cras dignissim dapibus sollicitudin. Sed in enim gravida odio cursus facilisis sagittis a elit.</p>
    <br>
    <p>Vestibulum magna nibh, blandit sed lectus in, eleifend vehicula sem. Sed maximus lectus a arcu pellentesque, quis porttitor dui laoreet. Nunc sit amet imperdiet mi, quis gravida lorem. Quisque eget efficitur nisi. Quisque est est, tristique vel commodo vitae, pharetra in mi.</p>
    <p>Vivamus turpis mi, interdum bibendum augue non, blandit ullamcorper enim. Sed eget dui faucibus, semper lorem vel, lobortis augue. Nam vitae nunc vitae elit gravida dignissim. Nam sapien est, porta sed libero quis, bibendum ultrices nisl. Pellentesque tincidunt augue id purus vestibulum, sed mattis orci viverra. Sed sed congue orci, nec interdum orci. Pellentesque condimentum augue pulvinar fermentum condimentum. Nam eleifend pulvinar risus id cursus. Sed tincidunt, nibh vitae fermentum accumsan, elit ex faucibus sem, ac eleifend urna leo id est.</p>
    <br>
    <p>Curabitur et libero nec est egestas scelerisque. Aliquam dictum blandit ante a blandit. Donec orci metus, blandit id semper eget, rhoncus blandit mi. Pellentesque vel convallis dui. Proin tortor ipsum, mollis sed laoreet ac, elementum a orci. Praesent risus ante, tempor nec turpis ac, ullamcorper rutrum mi. Morbi nec dolor tincidunt, tincidunt nibh vitae, euismod nunc.</p>
    <p>Nunc sed porta elit. Phasellus ullamcorper velit ligula, ut tincidunt nulla convallis ac. Maecenas at tempus turpis. Sed ultrices dapibus tortor, in pretium felis laoreet eu.</p>
    <br>
    <p>Proin condimentum tellus mauris, aliquam ultrices ligula consectetur quis. Nunc porta hendrerit nisl sit amet sollicitudin. Pellentesque dignissim nec orci ac venenatis. Aliquam accumsan scelerisque ante, at tempor erat luctus fringilla. Nulla vitae lacinia orci. Morbi sed ullamcorper dui. Sed ultrices hendrerit lobortis.<p>
    <br>
    <p>Nunc rhoncus volutpat aliquet. Sed a molestie purus. Quisque nisl elit, euismod vel sem sit amet, pulvinar sagittis turpis. Ut mollis sollicitudin metus at cursus. Ut tempus tincidunt lacus, eget pretium ex iaculis egestas. Duis diam sem, gravida mattis mattis sed, varius et elit. Curabitur iaculis lorem sit amet imperdiet auctor. Nunc in facilisis velit. Ut ac iaculis erat.<p>
    <br>
    <p>Donec fringilla diam a ipsum hendrerit tristique. Morbi porta hendrerit pellentesque. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Maecenas quam urna, tristique eu sodales a, ornare a nisi. Praesent quis maximus nibh. Vivamus suscipit congue mi, ut bibendum diam semper eget. Nulla condimentum mollis tristique. Aliquam non maximus ante. Nullam placerat posuere dui, vitae viverra dolor egestas et. Nam vehicula lacus tincidunt, rhoncus felis eget, accumsan ligula. Proin accumsan dolor ut commodo sollicitudin. Sed euismod purus vitae tortor luctus pulvinar.<p>
  </div>
  <div id="diagram"></div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="text/javascript">

var _ = go.GraphObject.make;
var viewDiagram =
  _(go.Diagram, "diagram",
    {
      "grid.visible": true,
      "undoManager.isEnabled": true,
      layout: _(go.LayeredDigraphLayout, // specify a Diagram.layout that arranges trees
                { direction: 90, layerSpacing: 25, columnSpacing: 100, setsPortSpots: false })
    });

// the definition of the grid system
viewDiagram.grid =
  _(go.Panel, "Grid",
    { gridCellSize: new go.Size(10, 10) },
    _(go.Shape, "LineH", { stroke: "rgba(128, 128, 128, .5)", strokeWidth: 0.2, interval: 2 }),
    _(go.Shape, "LineV", { stroke: "rgba(128, 128, 128, .5)", strokeWidth: 0.2, interval: 2 }),
    _(go.Shape, "LineH", { stroke: "rgba(128, 128, 128, .9)", strokeWidth: 0.4, interval: 10 }),
    _(go.Shape, "LineV", { stroke: "rgba(128, 128, 128, .9)", strokeWidth: 0.4, interval: 10 })
  );

// the template we defined earlier
viewDiagram.nodeTemplate =
  _(go.Node, "Auto",
    {
      isShadowed: true, shadowBlur: 1,
      shadowOffset: new go.Point(0, 1),
      shadowColor: "rgba(255, 255, 255, .2)",
      fromSpot: go.Spot.BottomSide,
      toSpot: go.Spot.TopSide,
      
      portId: "",
      cursor: "pointer",
      fromLinkable: true, fromLinkableSelfNode: true, fromLinkableDuplicates: true,
      toLinkable: true, toLinkableSelfNode: true, toLinkableDuplicates: true
    },
    
    _(go.Shape,
      "RoundedRectangle", // string argument can name a predefined figure
      { fill: "#fafafa", stroke: null },
      new go.Binding("fill", "backgroundColor")),

    _(go.TextBlock, "Default Text",
      { margin: 12, stroke: "black", font: "normal 16px sans-serif", textAlign: "center", verticalAlignment: go.Spot.Center },
      new go.Binding("text", "name"),
      new go.Binding("stroke", "textColor"))
  );

viewDiagram.linkTemplate =
  _(go.Link,
    // default routing is go.Link.Normal
    // default corner is 0
    {
      routing: go.Link.AvoidsNodes,
      corner: 10,
      adjusting: go.Link.Stretch,
      reshapable: true,
      relinkableFrom: true,
      relinkableTo: true
    },

    // the link path, a Shape
    _(go.Shape, { stroke: "#ffffff" }),

    // if we wanted an arrowhead we would also add another Shape with toArrow defined:
    _(go.Shape, { toArrow: "Standard", stroke: "#ffffff" }),
    
    _(go.TextBlock, { segmentOffset: new go.Point(0, -10), segmentOrientation: go.Link.OrientUpright, margin: 3, stroke: "rgba(255, 255, 255, .5)" },
      new go.Binding("text", "text"))
  );

viewDiagram.toolManager.linkingTool.temporaryLink =
  _(go.Link,
    { layerName: "Tool" },
    _(go.Shape,
      { stroke: "gray", strokeWidth: 2, strokeDashArray: [4, 2] })
  );

var tempFromNode =
  _(go.Node,
    { layerName: "Tool" },
    _(go.Shape, "RoundedRectangle",
      { stroke: "#ff3333", strokeWidth: 3, fill: null,
        portId: "", width: 1, height: 1 })
  );
viewDiagram.toolManager.linkingTool.temporaryFromNode = tempFromNode;
viewDiagram.toolManager.linkingTool.temporaryFromPort = tempFromNode.port;

var tempToNode =
  _(go.Node,
    { layerName: "Tool" },
    _(go.Shape, "RoundedRectangle",
      { stroke: "#ffff33", strokeWidth: 3, fill: null,
        portId: "", width: 1, height: 1 })
  );
viewDiagram.toolManager.linkingTool.temporaryToNode = tempToNode;
viewDiagram.toolManager.linkingTool.temporaryToPort = tempToNode.port;

var sampleModel = _(go.GraphLinksModel);
sampleModel.nodeDataArray =
[
  { key: "1", name: "Loading...", backgroundColor: null, textColor: "white" }
];
viewDiagram.model = sampleModel;

$.ajax({
  url: './1.json',
  cache: true,
  dataType: 'json',
  async: false,
  success: function(data) {
    var newDigModel = _(go.GraphLinksModel);
    var stories = data.stories || {};
    var ids = Object.keys(stories) || [];
    var nodes = [];
    var links = [];
    for(var i = 0; i < ids.length; ++i) {
      var node = { key: ids[i], name: '#' + ids[i] };
      if (data.start == ids[i]) {
        node.backgroundColor = '#1e90ff';
        node.textColor = '#ffffff';
      }
      nodes.push(node);
    }
    for(var i = 0; i < ids.length; ++i) {
      var page = stories[ids[i]];
      if (page.choice) {
        var choices = Object.keys(page.choice) || [];
        for(var j = 0; j < choices.length; ++j) {
          links.push({ from: ids[i], to: page.choice[choices[j]].next, text: page.choice[choices[j]].title });
        }
      } else {
        links.push({ from: ids[i], to: page.next, text: null });
      }
    }
    newDigModel.nodeDataArray = nodes;
    newDigModel.linkDataArray = links;
    viewDiagram.model = newDigModel;
  },
  // complete: console.log,
  error: function(req, status, error) {
    var newDigModel = _(go.GraphLinksModel);
    newDigModel.nodeDataArray = [{ key: 0, name: req.statusText.split(': ').join(':\n'), textColor: 'red', backgroundColor: null }];
    viewDiagram.model = newDigModel;
  }
});

</script>
</html>